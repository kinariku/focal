# Focal ウェイトリスト機能のセットアップ手順

## 概要
このウェイトリスト機能は、メールアドレスをGoogleスプレッドシートに保存し、確認メールを送信する機能です。既存のGoogle Apps Scriptを使用しており、追加のセットアップは不要です。

## 現在の設定状況

### ✅ 完了済み
- Googleスプレッドシートの設定（ID: `1-i9sTk0PXt6RLKFQ64t2vspUnCEE31aGY9QsFSgyicE`）
- シート名: `focal-waitlist`
- Google Apps Scriptの設定とデプロイ
- HTMLファイルのAPI連携設定

### 📧 メール送信の設定
メール送信機能を使用するには、Google Apps Scriptのプロパティに以下を設定する必要があります：

1. [Google Apps Script](https://script.google.com)にアクセス
2. プロジェクト「Focal Waitlist API」を開く
3. 左メニューの「プロパティ」をクリック
4. 「スクリプト プロパティ」タブを選択
5. 「スクリプト プロパティを追加」をクリック
6. 以下のプロパティを追加：
   - **プロパティ**: `RESEND_API_KEY`
   - **値**: Resend APIキー（[resend.com](https://resend.com)で取得）

### 🔧 必要に応じて設定を変更
以下の設定は必要に応じて変更できます：

1. **スプレッドシートID**: `api/waitlist.js`の`SHEET_ID`を変更
2. **シート名**: `api/waitlist.js`の`SHEET_NAME`を変更
3. **リダイレクトURL**: `api/waitlist.js`の`DEFAULT_REDIRECT_BASE`を変更

## 機能説明

### メール登録機能
- メールアドレスの入力とバリデーション
- Googleスプレッドシートへの自動保存
- 重複チェック（スプレッドシートとローカルストレージ両方で）

### キャッシュ機能
- ローカルストレージに登録済みメールアドレスを保存
- ページを再読み込みしても登録状態を維持
- 同じメールアドレスでの重複登録を防止

### UI状態管理
- 登録済みの場合、入力フィールドを無効化
- ボタンテキストを「登録済み」に変更
- 視覚的に登録済み状態を表示

## 使用方法

1. ユーザーがメールアドレスを入力して「早期アクセス」ボタンをクリック
2. メールアドレスがバリデーションされる
3. ローカルストレージで重複チェック
4. Googleスプレッドシートで重複チェック
5. 新規登録の場合、スプレッドシートに保存
6. ローカルストレージにメールアドレスを保存
7. UIを登録済み状態に更新

## エラーハンドリング

- 無効なメールアドレス形式
- ネットワークエラー
- サーバーエラー
- 重複登録の検出

## 注意事項

- Google Apps ScriptのURLは公開されるため、適切なアクセス制御を設定してください
- スプレッドシートのアクセス権限を適切に設定してください
- 本番環境では、より堅牢なバックエンドAPIの使用を検討してください
